@inherits LayoutComponentBase
@inject DialogService DialogService
@inject CookieThemeService CookieThemeService

<RadzenComponents @rendermode="InteractiveServer" />
@* Style="grid-template-areas: 'rz-sidebar rz-header' 'rz-sidebar rz-body' 'rz-sidebar rz-footer'" *@
<RadzenLayout>
    <RadzenHeader  style="padding:0.2rem;" Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0">
        <RadzenRow JustifyContent="JustifyContent.Start" AlignItems="AlignItems.Center">
            <RadzenColumn Size="5">
                <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Start" AlignItems="AlignItems.Center" Gap="0">
                    <RadzenSidebarToggle Click="ToggleSidebar" />                
                    <RadzenLabel Text="OpenHRCore" />
                </RadzenStack>
            </RadzenColumn>
            <RadzenColumn Size="7">
                <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.End" AlignItems="AlignItems.Center" Gap="2">
                    <RadzenAppearanceToggle class="rz-mr-3 rz-border-radius-10 rz-shadow-10" />
                    <RadzenProfileMenu class="rz-my-0 rz-p-0">
                        <Template>
                            <RadzenStack class="rz-py-3" Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Center" AlignItems="AlignItems.Center" Gap="3">
                                <RadzenIcon Icon="account_circle" />
                                <RadzenLabel Text="Administrator" />
                            </RadzenStack>
                        </Template>
                        <ChildContent>
                            <RadzenProfileMenuItem Path="user-profile" Text="User Profile" Icon="account_circle"></RadzenProfileMenuItem>
                            <RadzenProfileMenuItem Text="Edit" Icon="edit"></RadzenProfileMenuItem>
                            <RadzenProfileMenuItem Text="Notification" Icon="announcement"></RadzenProfileMenuItem>
                            <RadzenProfileMenuItem Path="login" Text="Logout" Icon="logout"></RadzenProfileMenuItem>
                        </ChildContent>
                    </RadzenProfileMenu>
                    <RadzenToggleButton Icon="settings" class="rz-mr-5 rz-border-radius-0 rz-shadow-0" ToggleIcon="settings"  Size="ButtonSize.Large" Click="@OpenSideDialog" />
                </RadzenStack>
            </RadzenColumn>
        </RadzenRow>
    </RadzenHeader>
    <RadzenSidebar @bind-Expanded="@sidebarExpanded" Responsive="true">
        <RadzenStack class="rz-my-5 rz-mx-3" Orientation="Orientation.Horizontal"  AlignItems="AlignItems.Center">
            <RadzenFormField AllowFloatingLabel="true" Variant="Variant.Outlined" Style="width: 100%;" Text="Search Program...">
                    <RadzenTextBox Name="Name" Placeholder="Search Program..." Value="" />
            </RadzenFormField>
        </RadzenStack>        
        <RadzenPanelMenu DisplayStyle="MenuItemDisplayStyle.IconAndText"   Click="OnParentClicked" ShowArrow="true" Multiple="@multiple">
            <RadzenPanelMenuItem Path="/" Text="Dashboard" Icon="dashboard" />
            <RadzenPanelMenuItem Expanded=true Text="Organization" Icon="home_app_logo">
                <RadzenPanelMenuItem Path="company-profile" Text="Company Profile" Icon="manage_accounts" />
                <RadzenPanelMenuItem Path="organization-unit" Text="Organization Units" Icon="account_tree"></RadzenPanelMenuItem>
            </RadzenPanelMenuItem>
            <RadzenPanelMenuItem  Expanded=true Text="WorkForce" Icon="groups">
                <RadzenPanelMenuItem Path="workforce/dashboard" Text="Dashboard" Icon="dashboard" />
                <RadzenPanelMenuItem Path="workforce/profile" Text="Profile" Icon="account_circle"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Path="workforce/employees" Text="Employees" Icon="manage_accounts"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Workforce Transitions" Icon="assignment_add"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Policies" Icon="policy"></RadzenPanelMenuItem>
            </RadzenPanelMenuItem>
            <RadzenPanelMenuItem Expanded=true Text="Career Connect" Icon="person_add">
                <RadzenPanelMenuItem Text="Dashboard" Icon="dashboard"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Jobs" Icon="work"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Candidates" Icon="person_search"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Stages" Icon="assignment_add"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Job Offers" Icon="assignment_add"></RadzenPanelMenuItem>
            </RadzenPanelMenuItem>
            <RadzenPanelMenuItem Expanded=true Text="Time Track" Icon="timer">
                <RadzenPanelMenuItem Text="Dashboard" Icon="dashboard"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Attendances" Icon="today"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Shift Assign" Icon="calendar_month"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Biometric Devices" Icon="devices"></RadzenPanelMenuItem>
            </RadzenPanelMenuItem>
            <RadzenPanelMenuItem Expanded=true Text="FlexiLeave" Icon="date_range">
                <RadzenPanelMenuItem Text="Dashboard" Icon="dashboard"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Leave Requests" Icon="assignment"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Leave Types" Icon="code"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Leave Policies" Icon="policy"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Leave Assignments" Icon="assignment_add"></RadzenPanelMenuItem>
            </RadzenPanelMenuItem>
            <RadzenPanelMenuItem Expanded=true Text="Pay Stream" Icon="attach_money">
                <RadzenPanelMenuItem Text="Dashboard" Icon="dashboard"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Payslips" Icon="paid"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Allowances" Icon="assignment_add"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Deductions" Icon="assignment_add"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Taxes" Icon="receipt"></RadzenPanelMenuItem>
            </RadzenPanelMenuItem>
            <RadzenPanelMenuItem Expanded=true Text="Reporting" Icon="folder_open">
                <RadzenPanelMenuItem Icon="assignment" Text="Career Connect"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Icon="assignment" Text="WorkForce"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Icon="assignment" Text="Time Track"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Icon="assignment" Text="FlexiLeave"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Icon="assignment" Text="Pay Stream"></RadzenPanelMenuItem>
            </RadzenPanelMenuItem>
            <RadzenPanelMenuItem Expanded=true Text="Configuration" Icon="construction">
                <RadzenPanelMenuItem Icon="deployed_code" Text="CareerConnect"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Icon="deployed_code" Text="WorkForce"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Icon="deployed_code" Text="TimeTrack"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Icon="deployed_code" Text="FlexiLeave"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Icon="deployed_code" Text="PayStream"></RadzenPanelMenuItem>
            </RadzenPanelMenuItem>
            <RadzenPanelMenuItem Expanded=true Text="Administration" Icon="settings">
                <RadzenPanelMenuItem Text="Users" Icon="manage_accounts"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Roles" Icon="admin_panel_settings"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Permissions" Icon="shield_person"></RadzenPanelMenuItem>
                <RadzenPanelMenuItem Text="Settings" Icon="manufacturing"></RadzenPanelMenuItem>
            </RadzenPanelMenuItem>
        </RadzenPanelMenu>

    </RadzenSidebar>
    <RadzenBody class="rz-m-0 rz-p-0">
        @Body
    </RadzenBody>
    <RadzenFooter>
        <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Center" AlignItems="AlignItems.Center" Gap="0">
            <RadzenLabel Text="© 2024 OpenHRCore. All rights reserved." />
        </RadzenStack>
    </RadzenFooter>
</RadzenLayout>

@code {
    string search_program = string.Empty;
    bool sidebarExpanded = true;
    bool multiple = true;

    private void ToggleSidebar() => sidebarExpanded = !sidebarExpanded;

    void OnParentClicked(MenuItemEventArgs args) { }

    void OnChildClicked(MenuItemEventArgs args) { }

    async Task OpenSideDialog()
    {

        await DialogService.OpenSideAsync<SideSettingDialog>("Settings",
            options: new SideDialogOptions
                {
                    CloseDialogOnOverlayClick = true,
                    Position = DialogPosition.Right,
                }
        );
    }

    [CascadingParameter]
    private HttpContext HttpContext { get; set; }

    [Inject]
    private ThemeService ThemeService { get; set; }

    protected override void OnInitialized()
    {
        base.OnInitialized();

        if (HttpContext != null)
        {
            var theme = HttpContext.Request.Cookies["OpenHrCoreTheme"];

            if (!string.IsNullOrEmpty(theme))
            {
                ThemeService.SetTheme(theme, false);
            }
        }
    }
}
